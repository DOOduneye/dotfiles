# ~/.config/tmux/tmux.conf

# === Prefix ===
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# === General Settings ===
set -g base-index 1
setw -g pane-base-index 1
set -g mouse on
set -g default-terminal "screen-256color"
set -g history-limit 10000
set -g set-clipboard on

# === Status Bar ===
set -g status-style bg=black,fg=white
set -g status-interval 10
set -g status-left "#[fg=green][#S] "
set -g status-left-length 20
set -g status-right "#(cat ~/.pomotui-status 2>/dev/null) #[fg=cyan]%d %b %R"
setw -g window-status-current-format '#{?window_zoomed_flag,#[fg=yellow],}#F#I [#W] '

# === Pane Navigation (vim-style) ===
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# === Window Navigation ===
bind C-p previous-window
bind C-n next-window

# === Session Navigation ===
bind-key ) switch-client -n
bind-key ( switch-client -p
bind-key s choose-tree -sZ

# === Sessionizer ===
bind-key f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"

# === Pane Management ===
bind-key -n C-Space resize-pane -Z
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind -r C-M-Left  resize-pane -L 5
bind -r C-M-Right resize-pane -R 5
bind -r C-M-Up    resize-pane -U 5
bind -r C-M-Down  resize-pane -D 5

# === Copy Mode (vim-style) ===
setw -g mode-keys vi
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'pbcopy'
bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel 'pbcopy'
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# === Reload Config ===
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Reloaded!"

# === Plugins (TPM) ===
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Resurrect settings
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-capture-pane-contents 'on'

# Continuum settings (auto-save every 15 min, auto-restore on start)
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Initialize TPM (keep at bottom)
run '~/.tmux/plugins/tpm/tpm'
